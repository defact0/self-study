### AWS Solutions Architect - Associate (SAA) 연습 1

---

애플리케이션은 **AWS 자격 증명**으로 API 요청에 서명해야 합니다. 

1. IAM 역할을 생성합니다.
2. 역할을 수행할 수 있는 계정 또는 AWS 서비스를 정의합니다.
3. 역할을 수행하서 애플리케이션이 사용할 수 있는 API 작업 및 리소스를 정의합니다.
4. 인스턴스를 시작할 때 역할을 지정하거나, 기존 인스턴스에 역할을 연결합니다.
5. 애플리케이션에서 임시 자격 증명 세트를 검색하여 사용하도록 합니다.

---

Windows 서버로 구성, <u>더 높은 대역폭, 더 높은 패킷당 성능 (PPS) 성능을 제공하고 인스턴스 간 대기 시간을 지속적으로 낮추도록</u> 해야  하기 위하여 Windows EC2 인스턴스에서 **EFA (Elastic Fabric Adapter)**를 사용하여 향상된 네트워킹 활성화 합니다

---

<u>Snowball에서 Glacier로 데이터를 직접 이동할 수는 없습니다.</u> 먼저 S3를 거친 다음 수명주기 정책을 사용해야 합니다.

- Glacier Deep Archive는 Glacier보다 더 많은 비용을 절감하므로 Glacier Deep Archive를 사용하여 이 사용 사례의 장기 보관을 수행해야 합니다.

----

올바른 CIDR 표기법을 사용

- <u>/ 32는 하나의 IP 주소</u>
- / 0은 전체 네트워크

----

**부팅 가능한 볼륨**

- SSD 볼륨 = 가능
- HDD 볼륨 = 불가

EBS 프로비저닝된 IOPS SSD(io1)

- Amazon EBS 프로비저닝 IOPS SSD (io1)는 가장 비용 효율적인 EBS 유형이 아니며 IOPS 성능이 지속적으로 요구되는 중요한 비즈니스 애플리케이션에 주로 사용

----

**SSE-S3**

- Amazon S3 `관리형 키`를 사용한 서버 측 암호화
- 각 객체는 고유한 키로 암호화 / 고급 암호화 표준(AES-256)을 사용

**SSE-KMS**

- AWS Key Management Service에 저장된 `고객 마스터 키(CMK)`를 사용한 서버 측 암호화
- 비용이 발생 / 감사 추적 기능을 제공 / AWS 관리형 CMK를 사용

**SSE-C**

- `고객 제공 키`를 사용한 서버 측 암호화
- Amazon S3는 암호화(디스크에 쓸 때) 및 해독(객체에 액세스할 때)을 관리

---

라우팅 테이블에는 서브넷 또는 게이트웨이의 네트워크 트래픽이 전송되는 위치를 결정하는 데 사용되는 라우팅이라는 규칙 집합이 포함, 라우팅 테이블에 `인터넷 게이트웨이 추가`

- IPv4 트래픽의 경우 대상 0.0.0.0/0
- IPv6 트래픽의 경우 :: / 0

---

다중 AZ 배포로 구성된 RDS 데이터베이스를 사용, 기본 데이터베이스 인스턴스가 실패할 경우 RDS는 어떻게?

- 장애 조치 시, Amazon RDS는 <u>DB 인스턴스의 정식 이름 레코드(CNAME)가 예비 복제본을 가리키도록 변경</u>합니다. 그러면 이 예비 복제본이 승격되어 새 기본 복제본이 됩니다.
- 장애 조치는 Amazon RDS가 자동으로 처리

---

Amazon S3에 호스팅 된 파일을 실수로 삭제하여 서비스가 중단되는 상황을 예방하는 방법은?

- 버킷의 S3버전 관리 및 MFA Delete가 활성화

---

**[상황예시]** 8개의 Amazon EC2 인스턴스 운영

- 각 인스턴스에서 약 55%의 리소스를 사용
- Auto Scaling을 사용하여 8개의 인스턴스가 항상 실행 중인지 확인
- 처리하는 요청 수는 일관되고 급증하지 않는다
- 고가용성을 항상 보장 / 로드를 모든 인스턴스 간에 균등하게 분산 / 모든 EC2 인스턴스에 대해 동일한 AMI(Amazon Machine Image)를 사용

**[해결방안]** Amazon Elastic Load Balancer 뒤의 동일한 리전에서 하나의 가용 영역에 4개의 EC2 인스턴스와 다른 가용 영역에 4개의 EC2 인스턴스를 배포

---

**AWS Lambda**를 사용하여 Amazon S3 버킷 또는 Amazon DynamoDB 테이블의 데이터 변경과 같은 이벤트에 대한 응답으로 코드를 실행할 수 있습니다.
Lambda를 사용하여 Amazon S3 및 Amazon DynamoDB와 같은 `AWS 서비스에 대한 데이터 처리 트리거를 손쉽게 빌드`하거나, Kinesis에 저장된 스트리밍 데이터를 처리하거나 AWS 규모, 성능, 보안에 따라 작동하는 <u>자체 백엔드를 생성할 수 있습니다.</u>

---

**[상황예시]**  EC2 인스턴스에서 최소 허용 성능 임계값을 유지하려면 최소 10개 이상의 인스턴스가 필요하고 워크로드의 급증 문제를 처리하려면 100개 인스턴스가 필요한데, 과거 워크로드를 기준으로 하면 80%의 인스턴스가 필요하다

**[해결방안]** 예약 인스턴스 80개 구매하고 상황을 봐서 추가 온디맨드 및 스팟 인스턴스를 프로비저닝 한다.

---

AWS 스택 생성 시 ELB의 도메인 이름 서버 호스트 이름을 얻는 방법은?

- **Outputs**

스택의 속성을 볼 때마다 반환되는 값을 설명하는 CloudFormation 템플릿의 선택적 섹션

---

**[상황예시]** 암호화 키 순환을 자동화하는 스토리지 시스템을 설정하라 또한 누가 암호화 키를 사용했으며 보안 목적으로 누가 사용했는지 보여주는 감사 추적도 제공해라

**[해결방안]**

- AWS KMS 관리형 키 (SSE-KMS)를 사용하여 서버 측 암호화를 구성
- Amazon S3를 사용하여 데이터 저장

---

**[상황예시]** AWS ID 및 액세스 관리 서비스 사용, AWS 리소스에 대한 엄격한 액세스 구현

**[해결방안]**

- IAM 그룹
- 자격 증명 공급자

`보안 그룹`은 IAM 대시 보드가 아닌 EC2 콘솔에서 관리 할 수 있다.

---

**[상황예시]** AWS Fargate 를 쓰는데, 최소 ECS 작업 수는 처음에 1로 설정되어 비용을 절약하고 S3 버킷에 업로드된 새 객체를 기반으로 작업 수만 증가시킵니다. 처리가 완료되면 버킷이 비게 되고 ECS 작업 수는 1로 다시 설정되어야 합니다.

**[해결방안]** S3 객체 PUT 작업을 탐지하도록 CloudWatch 이벤트 규칙 설정, 작업이 증가함에 따라 대상을 ECS 클러스터로 설정. S3 DELETE 작업을 탐지하는 다른 규칙 생성하고 작업 수를 1로 하여 대상을 ECS 클러스터로 설정

---

**[상황예시]** 애플리케이션 계층의 트래픽만 허용하고 다른 소스의 트래픽은 거부하도록 데이터베이스 계층에 대한 액세스를 제한. 애플리케이션 계층은 EC2 인스턴스의 Auto Scaling 그룹에서 호스팅 되는 애플리케이션 서버로 구성

**[해결방안]** `VPC 공유`를 사용하여 하나 이상의 서브넷을 <u>AWS Organizations의 동일한 상위 조직에 속한 다른 AWS 계정과 공유</u>

---

**연결 드레이닝**

- 로드 밸런서가 인스턴스의 등록 취소를 보고하기 전에 연결을 유지할 수 있는 최대 시간을 지정할 수 있습니다. 최대 제한 시간 값의 범위는 1 ~ 3,600초입니다(기본은 300초). 최대 제한 시간에 도달하면 로드 밸런서는 등록 취소 중인 인스턴스로의 연결을 강제로 종료합니다.

---

**[상황예시]** 기본 EC2 인스턴스의 CPU 활용률이 약 50%일 때 주요 애플리케이션이 최대 성능에서 작동. Auto Scaling 그룹에서 관리되는 EC2 인스턴스 그룹을 기반으로 구축. 워크플로우 요청은 요청을 인스턴스로 라우팅하는 내부 Application Load Balancer에 의해 처리, 애플리케이션이 최고 성능 상태에 가깝게 실행되도록 하려면 어떻게?

**[해결방안]** `대상 추적 정책`을 사용하도록 Auto Scaling 그룹을 구성, CPU 사용률을 대상 값이 50% 인 대상 지표로 설정

`대상 추적 조정 정책`은 지정한 측정치가 목표 값을 초과할 때 한해서 Auto Scaling 그룹을 확장하도록 되어 있습니다. 대상 추적 조정 정책에서는 지정한 측정치가 목표 값보다 작을 때 Auto Scaling 그룹을 확장할 수 없습니다.

----

**[상황예시]** 성능을 확인하니 데이터베이스에 대한 쓰기 처리량을 개선할 필요가 있다.

**[해결방안]**

- 두 개의 EBS 볼륨으로 표준 RAID 0 구성을 설정
- EC2 인스턴스의 크기를 늘린다.

----

**[상황예시]** www.example.com의 수신 트래픽을 모든 AWS 리전의 모든 EC2 인스턴스로 라우팅하도록 지연 시간 기반 라우팅을 설정하도록 지시했습니다

**[해결방안]** Route 53 을 사용, 모든 AWS 리전에서 여러 EC2 인스턴스로 로드를 분산

> 로드 밸런서는 트래픽을 다른 AWS 리전으로 분산하지 않고 해당 리전 내에서만 분산합니다. 대신 Route 53을 사용하여 두 개 이상의 AWS 리전으로 들어오는 로드를 밸런싱하는 것이 가장 좋습니다.

----

**[상황예시]** 키 관리를 위해 CloudHSM를 사용하려고 한다. 그런데 비밀번호를 실패하여 HSM이 초기화 되어 암호키가 지워졌는데 키를 복구할 수 있는 방법이 없을까?

**[해결방안]** 사본이 없으면 키가 영구적으로 손실된다.

---

AWS 계정 루트 사용자를 생성 할 때 따라야 하는 보안 권장 사항

- AWS 계정 루트 사용자의 강력한 비밀번호 생성
- AWS 계정 루트 사용자 계정에 멀티 팩터 인증(MFA)를 활성화

----

IAM 정책을 생성할 때 가장 좋은 방법

- 작업을 수행하는 데 필요한 권한 만 부여하는 `최소 권한 원칙`을 사용

---

AWS DataSync를 사용하여 지정된 AWS 스토리지 서비스로 온라인 데이터 전송을 자동화하고 가속해라.

- 온라인 데이터 전송 서비스, AWS Direct Connect를 통해 AWS 스토리지 서비스에서 송수신되는 대량의 데이터 복사를 간소화, 자동화 및 가속화

---

Auto Scaling에서 결정하는 인스턴스 종료 정책

- 인스턴스 수가 가장 많은 가용 영역을 선택
- 다음 청구 시간에 가장 가까운 인스턴스 선택
- 가장 오래된 시작 구성이 있는 인스턴스를 선택

---

**[상황예시] **클릭 스트림 분석을 포함하여 웹 사이트 및 모바일 애플리케이션에서 전 세계에 배포된 사용자 활동을 추적하고 분석할 수 있습니다. 클라우드 아키텍처는 데이터를 사용자와 지리적으로 근접하게 처리하고 낮은 지연 시간에 사용자 요청에 응답해야 합니다.

**[해결방안]** CloudFront를 Lambda@Edge와 통합하여 사용자와 지리적으로 가까운 곳에서 데이터를 처리하고 낮은 지연 시간에 사용자 요청에 응답.
Kinesis를 사용하여 실시간 스트리밍 데이터를 처리하고 결과를 Amazon S3 버킷에 지속해서 저장

```log
지연 시간 기반 라우팅 정책과 함께....
지리적 근접성 라우팅 정책과 함께.....

=> 컴퓨팅 기능이 없기 때문에 Route 53을 사용하여 트래픽만 라우팅 할 수 있어 둘 다 잘못되었다.
```

---

AWS Lambda 및 API Gateway에 내장 된 API를 사용, 트래픽 급증으로부터 플랫폼의 백엔드 시스템을 어떻게 보호 할 수 있습니까?

-  API Gateway에서 제한 설정 및 결과 캐싱을 사용하도록 설정

---

퍼블릭 서브넷과 인터넷 게이트웨이가 있는 VPC를 설정했는데, 인터넷을 통해 인스턴스에 연결할 수 없다. 관련 보안 그룹을 확인했는데 문제가 없는 것 같다.

- 기본 라우팅 테이블을 확인하고 인터넷 게이트웨이 (IGW)에 대한 올바른 라우팅 항목이 구성되어 있는지 확인

----

Amazon S3 Standard-Infrequent Access 스토리지 클래스

- 필요할 때 빠르게 액세스 해야 하는 데이터를 위해 설계
- 덜 자주 액세스하는 데이터를 위해 설계

---

모든 데이터를 저장할 블록 스토리지를 찾고 있으며 EBS 볼륨과 함께 사용하기로 결정했습니다. 상사는 규정 준수 요구 사항, 다운타임 시나리오 및 IOPS 성능으로 인해 EBS 볼륨이 워크로드에 적합하지 않다고 우려하는 것을 어떻게 설득?

- EBS 볼륨은 프로덕션 중에 실시간 구성 변경을 지원하므로 서비스 중단 없이 볼륨 유형, 볼륨 크기 및 IOPS 용량을 수정할 수 있다.
- EBS 볼륨은 인스턴스의 수명과는 독립적으로 유지될 수 있는 오프인스턴스 스토리지 이다.

----

보안 그룹은 EC2 인스턴스에 대한 수신 및 발신 트래픽을 제어하는 가상 방화벽 역할을 합니다.

- 인스턴스를 시작한 이후에는 해당 보안 그룹을 변경할 수 없습니다
- 인스턴스의 보안 그룹을 변경하면 기본 네트워크 인터페이스(eth0)와 연결된 보안 그룹이 변경됩니다.
- 인터넷 게이트웨이 ID를 인바운드 규칙의 사용자 지정 소스로 사용할 수 없습니다.

---

**[상황예시]** Amazon SQS에서 표준 대기열을 사용하고 있는 웹 기반 주문 처리 시스템이 있습니다. 지원팀은 주문이 두 번 처리된 사례가 많다는 것을 알게 되었습니다. 해결방안은?

**[해결방안]**

- Amazon SQS FIFO 대기열을 사용
- Amazon SQS를 교체하고 대신 Amazon Simple Workflow 서비스를 사용
  - Amazon Simple Workflow Service(Amazon SWF)는 분산 애플리케이션 구성 요소에서 작업을 쉽게 조정할 수 있도록 해주는 웹 서비스입니다.

----

**[상황예시]**  Amazon S3 버킷에 저장하고 있습니다. 버킷에 추가된 모든 새 객체와 제거된 객체를 모두 추적하도록 아키텍처를 구성해야 하고 버전이 지정된 객체가 영구적으로 삭제되는지 여부를 추적해야 합니다. 이벤트에 대한 알림을 사후 처리를 위한 대기열과 운영팀에 알릴 Amazon SNS 주제에 게시하도록 Amazon S3를 구성해야 합니다.

**[해결방안]** 새로운 Amazon SNS 주제와 Amazon SQS 대기열을 생성한다. 버킷에 S3 이벤트 알림 구성을 추가하여 `s3: objectCreated: * `및 `s3: objectRemoved: Delete` 이벤트 유형을 SQS 및 SNS에 게시한다.

---

다중 AZ 구현을 사용하여 데이터베이스 복제를 자동화하고 데이터 내구성을 향상시키며 읽기 복제본을 배포합니다. 해당 내용을 요약하면?

- <u>다중 AZ는 `동기식 복제`를 따르며</u> 단일 리전 내에 최소 두 개의 가용 영역을 포함
- <u>읽기 전용 복제본은 `비동기 복제`를 따르며</u> 가용 영역, 교차 AZ 또는 교차 리전 내에 있을 수 있다.

---

대용량 데이터 레코드를 실시간으로 수집하고 처리하는 데 사용할 수 있는 AWS 서비스는?

- Amazonn Kinesis Data Sreaams

> Amazon Redshift
> 데이터 웨어하우징에 사용되므로 데이터 웨어하우스 및 데이터 호수 전반에서 데이터를 간편하고 비용 효율적으로 분석
> 대규모 데이터 스트림을 실시간으로 수집하고 처리할 수 있어야 하는 요구 사항을 충족하지 못함

> Amazon SWF
> Amazon의 클라우드를 사용하여 분산된 구성 요소 간에 작업을 조정하고 대규모 데이터 레코드를 처리하는 방법으로 사용되지 않는 애플리케이션을 구축하는 데 사용

---

기본 데이터베이스 인스턴스에서 시스템 장애가 발생하는 경우 장애 조치 중에 Amazon Aurora는 어떻게 됩니까?

- Aurora는 먼저 원래 인스턴스와 <u>동일한 가용 영역에 새 DB 인스턴스를 생성</u>하려고 시도한다. 그렇게 할 수 없는 경우 Aurora는 <u>다른 가용 영역에서</u> 새 DB 인스턴스를 생성하라고 시도 한다.
- 동일하거나 다른 가용 영역에 Amazon Aurora 복제본이 있는 경우 장애 조치 시 Amazon Aurora는 DB 인스턴스의 표준 이름 레코드 (CNAME)를 정상 복제본을 가리 키도록 하여 새로운 복제본으로 승격
- 장애 조치는 일반적으로 30초 내에 완료

---

CloudTrail 에서 처리할 수 없는 것

- 리퍼러 및 처리 시간 정보
- S3 버킷으로 전송된 모든 액세스 요청

필요한 모든 Amazon S3 버킷에 대해 서버 액세스 로깅을 활성화

---

기본적으로 Amazon EC2 및 Amazon VPC는 IPv4 주소를 사용하며 VPC를 생성할 때는 IPv4 CIDR 블록(전용 IPv4 주소 범위)을 할당해야 합니다. 인터넷을 통해 프라이빗 IPv4 주소에 연결할 수 없습니다. 인터넷을 통해 인스턴스에 연결하거나 인스턴스와 퍼블릭 엔드 포인트가 있는 <u>다른 AWS 서비스 간의 통신을 활성화하려면 인스턴스에 글로벌 고유 퍼블릭 IPv4 주소를 할당</u> 할 수 있습니다.

---

AWS Organizations는 AWS의 워크로드가 증가하고 확장됨에 따라 환경을 중앙에서 관리하는 데 도움이 됩니다. 

AWS Organizations를 활용하면 계정에서 허용되는 서비스 및 작업을 제한할 수 있습니다. 서비스 제어 정책(SCP)을 사용하여 AWS Identity and Access Management(IAM) 사용자 및 역할에 대한 권한 보호 계층을 적용할 수 있습니다. 예를 들어 조직 계정의 사용자가 명시적으로 허용되지 않는 리전에서 리소스를 실행하지 못하도록 제한하는 SCP를 적용할 수 있을 것입니다.

---

**[상황예시]** 웹 사이트를 공개 로드 밸런서 뒤에 있는 웹 서버 클러스터에서 호스팅하고 있으며 Amazon Route 53을 사용하여 퍼블릭 DNS를 관리합니다.
고객의 로드 밸런서를 가리키도록 DNS zone apex 레코드를 어떻게 구성

**[해결방안]** 로드 밸런서 DNS 이름으로 별칭이 지정된 A 레코드를 만든다.

CNAME(Canonical Name)

- 하나의 도메인에 도메인 별칭을 부여하는 방식

A 레코드

- 도메인(domain) name에 IP Address를 매핑하는 방법

```shell
# CNAME
abc.com -> abc.alpha.com

# A record
abc.alpha.com -> 211.230.23.122
```

**Zone Apex (Root Domain, Naked Domain)**

- 서브도메인이 붙지 않은 도메인을 Zone Apex라 부른다.
  (Root Domain, Naked Domain이라고도 불린다)
- 예를 들어, 자신이 등록한 도메인 이름이 example.com 이라면,
  앞에 서브도메인이 붙지 않는, "example.com" 자체는 Zone Apex라 칭한다.

----

메시지 지향 미들웨어 시스템에서 Amazon SQS로 메시징 대기열을 마이그레이션 하여 비용을 최소화 하려고 하는데 그 방법은?

- SQS 긴 폴링을 사용하여 Amazon SQS 대기열에서 메시지를 검색한다.
- 긴 폴링을 사용하면 빈 응답을 수신하는 횟수를 줄일 수 있으므로 SQS 사용 비용을 절감할 수 있습니다.

